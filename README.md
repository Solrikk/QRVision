## Что такое подключение на основе API?

**API (Application Programming Interface)** — это набор определений и протоколов, который позволяет различным программным системам взаимодействовать между собой. В основном, API используется для того, чтобы одна программа могла запросить данные или вызвать функции другой программы, без необходимости углубляться в её внутренности. API скрывает внутреннюю реализацию и предоставляет лишь то, что нужно для взаимодействия.

Представьте себе API как меню в ресторане. Меню предоставляет список блюд, которые можно заказать, и рассказывает, как кухня их приготовит. Когда вы делаете заказ, кухня знает, как его приготовить и подать вам. Точно так же API предоставляет список операций, которые программист может использовать, с точными инструкциями по их выполнению.

**API-запрос** — это обращение к API для выполнения определённой операции, например, создания или обновления данных. В данном случае мы отправляем информацию о продукте на маркетплейс.

#### Можно использовать другие REST-клиенты, например, **Postman** и т.д. 

## Пример команды: POST /products/ (Создание товара)
-  Данные должны приходить в теле **HTTP** запроса в соответствии с переданным Content-type.
-  В случае, если товар создать не удалось, будет возвращен статус HTTP/1.1 **400 Bad Request**.
-  В случае успеха будет возвращён статус HTTP/1.1 201 Created и ID нового продукта.
-  Обязательные параметры: **product** и **category_ids**.
-  Главной категорией будет первый ID (в примере это 12).

```Python
curl --header "Authorization: Basic 7tG22bH227mzYNA431R58lC66286L4uI" \
     --header 'Content-Type: application/json' \
     -X POST 'https://kubatura.ru/api/2.0/products' \
     --data-binary '{"product_id":"12","product_code":"U0012O5AF0","list_price":"45.00","price":"30.000000","status":"A","amount":"10","product":"100g Pants"}'
```

_Разберём команды по частям:_
1. **cURL** - Позволяет выполнять любые HTTP методы для нужного ресурса. Можно передавать любые параметры запросов и заголовков, а также проверять ответные заголовки и данные. Инструмент коммандной строки «curl», стандартен для большинства *nix систем. Для пользователей Windows подойдёт MinGW/MSYS.
2. **--header "Authorization: Basic 7tG22bH227mzYNA431R58lC66286L4uI**" - Эта часть добавляет заголовок к запросу. Здесь используется заголовок авторизации, который несёт токен доступа, подтверждающий вашу личность и разрешающий доступ к API. В данном случае используется базовая авторизация (Basic) с заранее закодированным токеном.
3. **--header 'Content-Type: application/json'** - Этот заголовок указывает, что данные, отправляемые в запросе, находятся в формате JSON.
4. **-X POST** - Указывает метод запроса. Здесь используется метод POST, который обычно применяется для создания новых ресурсов или данных на сервере.

## Пример команды: PUT /products/:id (Обновление товара) 
-  1 и 2: id склада или магазина
-  15 и 9: количество товаров на складах
-  Данные должны приходить в теле **HTTP** запроса в соответствии с переданным Content-type.
-  В случае, если товар обновить не удалось, будет возвращен статус HTTP/1.1 ****400 Bad Request****.

```Python
curl --header "Authorization: Basic 7tG22bH227mzYNA431R58lC66286L4uI" \
 --header 'Content-Type: application/json' \
 -X PUT 'https://kubatura.ru/api/2.0/products' \
 --data-binary '{"warehouses": {"1": "15","2": "9"}}'
```

## Пример команды: DELETE /products/:id (удаление товара)

-  В случае, если товар удалить не удалось, будет возвращен статус HTTP/1.1 400 Bad Request.
-  В случае, если такой товар не существует, будет возвращен статус HTTP/1.1 404 Not Found.
-  В случае успеха будет возвращён статус HTTP/1.1 204 No Content.
```Python
curl --header "Authorization: Basic 7tG22bH227mzYNA431R58lC66286L4uI" \
 -X DELETE 'https://kubatura.ru/api/2.0/products/12'
```
Фактические данные, отправляемые на сервер. Здесь это JSON-объект с информацией о продукте, который мы хотим добавить или обновить:
```JSON
{
  "product_id": "12",
  "product_code": "U0012O5AF0",
  "list_price": "45.00",
  "price": "30.000000",
  "status": "A",
  "amount": "10",
  "product": "100g Pants"
}
```

## Почему важно подключение через API?

1. **Автоматизация процессов**: Использование API позволяет **автоматизировать** многие процессы, такие как обмен данными между системами, обновление информации и управление ресурсами. Это сокращает время и усилия на выполнение задач вручную и **снижает шанс ошибок**. Например, для маркетплейса Кубатура API может автоматически **загружать** и **обновлять** товары, что обеспечивает актуальность каталога без необходимости ручного вмешательства.
2. **Улучшение обмена данными**: API позволяет различным системам обмениваться данными в реальном времени. На маркетплейсе Кубатура это означает, что информация о товарах, **наличиях и ценах** **обновляется мгновенно**, что важно для поддержания актуальности информации и обеспечения плавного использования различных сервисов.
3. **Гибкость и расширяемость**: С помощью API можно быстро добавлять новые функции и возможности в существующие системы без необходимости радикальных изменений. Это делает системы более гибкими и легко расширяемыми. Для Кубатура API можно использовать для интеграции новых поставщиков, добавления новых категорий товаров и улучшения пользовательского опыта.
4. **Безопасность**: API-запросы могут включать разные методы аутентификации и авторизации, такие как использование токенов доступа. Это позволяет контролировать доступ к данным и функциям, повышая безопасность взаимодействия между системами. В случае маркетплейса Кубатура, использование API с аутентификацией помогает защитить конфиденциальную информацию о товарах и контролировать, кто имеет право вносить изменения в каталог.

## Архитектура подключения на основе API

Архитектура подключения на основе API описывает, как различные компоненты системы взаимодействуют посредством API для обмена данными или выполнения операций. Основные элементы этой архитектуры включают сервер API, клиентов API, методы запросов и безопасности.

Основной протокол для передачи данных в интернете. Большинство современных API используют **HTTP** или его безопасный вариант **HTTPS** для передачи данных.
### Примеры методов:
-  **GET**:  Запрос данных с сервера. Например, с помощью GET запроса можно получить список всех товарах, доступных на Кубатуре.
-  **POST**: Создание новых данных на сервере. Продавцы могут использовать POST запрос для добавления новых товаров в каталог маркетплейса.
-  **PUT**: Обновление существующих данных. С помощью PUT запроса продавцы могут обновлять информацию о товарах, например, изменять цены или описание.
-  **DELETE**: Удаление данных с сервера. Если товар больше не доступен для продажи, продавец может использовать DELETE запрос для его удаления из каталога.

## Как МП Кубатура Обеспечивает подключение через API

МП Кубатура подключается к платформе CS-Cart через REST API. (https://www.cs-cart.ru/docs/latest/developer_guide/api/)

1. **RESTful API (Representational State Transfer API)** — это архитектурный стиль для создания API, который использует HTTP-запросы для выполнения стандартных операций (CRUD — создание, чтение, обновление, удаление данных). В RESTful API используются методы HTTP (GET, POST, PUT, DELETE) для взаимодействия с серверными ресурсами.

2.  **HTTP**: Это протокол, который используется для передачи данных в интернете. Он включает в себя методы (такие как GET, POST, PUT и DELETE), статусы (например, 200 OK, 404 Not Found), и заголовки (которые содержат дополнительную информацию о запросе или ответе). 
- **HTTP** — это протокол, который используется для передачи данных через интернет. Он помогает компьютерам общаться друг с другом.

## Заключение: 

Подключение через API позволяет автоматизировать процессы, улучшить обмен данными между системами, обеспечить гибкость и расширяемость инфраструктуры, а также повысить безопасность взаимодействий. Используя стандартные методы HTTP (GET, POST, PUT, DELETE), API обеспечивает эффективное управление ресурсами и данными, что особенно полезно для платформ, таких как маркетплейсы.
